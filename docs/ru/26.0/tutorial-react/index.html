<!DOCTYPE html><html lang="ru"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Testing React Apps · Jest</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="В Facebook мы используем Jest для тестирования [React](https://reactjs.org/) приложений."/><meta name="docsearch:version" content="26.0"/><meta name="docsearch:language" content="ru"/><meta property="og:title" content="Testing React Apps · Jest"/><meta property="og:type" content="website"/><meta property="og:url" content="https://jestjs.io/"/><meta property="og:description" content="В Facebook мы используем Jest для тестирования [React](https://reactjs.org/) приложений."/><meta property="og:image" content="https://jestjs.io/img/opengraph.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://jestjs.io/img/jest.png"/><link rel="shortcut icon" href="/img/favicon/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://jestjs.io/blog/atom.xml" title="Jest Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://jestjs.io/blog/feed.xml" title="Jest Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-44373548-17', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="/css/code-block-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/ru"><img class="logo" src="/img/jest.svg" alt="Jest"/><h2 class="headerTitleWithLogo">Jest</h2></a><a href="/ru/versions"><h3>26.0</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/ru/26.0/getting-started" target="_self">Документация</a></li><li class="siteNavGroupActive"><a href="/docs/ru/26.0/api" target="_self">API</a></li><li class=""><a href="/ru/help" target="_self">Справка</a></li><li class=""><a href="/blog/" target="_self">Блог</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>Русский</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/en/26.0/tutorial-react">English</a></li><li><a href="/docs/ja/26.0/tutorial-react">日本語</a></li><li><a href="/docs/es-ES/26.0/tutorial-react">Español</a></li><li><a href="/docs/pt-BR/26.0/tutorial-react">Português (Brasil)</a></li><li><a href="/docs/ro/26.0/tutorial-react">Română</a></li><li><a href="/docs/uk/26.0/tutorial-react">Українська</a></li><li><a href="/docs/zh-Hans/26.0/tutorial-react">简体中文</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="https://github.com/facebook/jest" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Возможности фреймворка</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Introduction</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/getting-started">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/using-matchers">Using Matchers</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/asynchronous">Testing Asynchronous Code</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/setup-teardown">Setup and Teardown</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/mock-functions">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/jest-platform">Jest Platform</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/jest-community">Jest Community</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/more-resources">More Resources</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Guides</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/snapshot-testing">Snapshot Testing</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/tutorial-async">An Async Example</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/timer-mocks">Timer Mocks</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/manual-mocks">Manual Mocks</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/es6-class-mocks">ES6 Class Mocks</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/bypassing-module-mocks">Bypassing module mocks</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/ecmascript-modules">ECMAScript Modules</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/webpack">Using with webpack</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/puppeteer">Using with puppeteer</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/mongodb">Using with MongoDB</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/dynamodb">Using with DynamoDB</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/tutorial-jquery">DOM Manipulation</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/watch-plugins">Watch Plugins</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/migration-guide">Migrating to Jest</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/troubleshooting">Troubleshooting</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/architecture">Architecture</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Возможности фреймворка</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/docs/ru/26.0/tutorial-react">Testing React Apps</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/tutorial-react-native">Testing React Native Apps</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/testing-frameworks">Testing Web Frameworks</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">API Reference</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/api">Globals</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/expect">Expect</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/mock-function-api">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/jest-object">The Jest Object</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/configuration">Configuring Jest</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/cli">Jest CLI Options</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/26.0/environment-variables">Environment Variables</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/facebook/jest/edit/master/docs/TutorialReact.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Testing React Apps</h1></header><article><div><span><p>В Facebook мы используем Jest для тестирования <a href="https://reactjs.org/">React</a> приложений.</p>
<h2><a class="anchor" aria-hidden="true" id="настройка"></a><a href="#настройка" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Настройка</h2>
<h3><a class="anchor" aria-hidden="true" id="настройка-с-create-react-app"></a><a href="#настройка-с-create-react-app" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Настройка с Create React App</h3>
<p>If you are new to React, we recommend using <a href="https://create-react-app.dev/">Create React App</a>. Готово к использованию и <a href="https://create-react-app.dev/docs/running-tests/#docsNav"> поставляется вместе с Jest</a>! Вам понадобится только добавить  <code>react-test-renderer</code> для рендеринга снимков.</p>
<p>Запуск</p>
<pre><code class="hljs css language-bash">yarn add --dev react-test-renderer
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="настройка-без-create-react-app"></a><a href="#настройка-без-create-react-app" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Настройка без Create React App</h3>
<p>Если у вас есть существующее приложение, то вам понадобится установить несколько пакетов, чтобы все хорошо работало в совместности. Мы используем пакет <code>babel-jest</code> и Babel прежде для <code>react</code>, чтобы преобразовать код внутри окружения для тестирования. Также см. <a href="/docs/ru/26.0/getting-started#using-babel">использование Babel</a>.</p>
<p>Запуск</p>
<pre><code class="hljs css language-bash">yarn add --dev jest babel-jest @babel/preset-env @babel/preset-react react-test-renderer
</code></pre>
<p>Ваш <code>package.json</code> должен выглядеть примерно так (где <code>&lt;current-version&gt;</code> это фактический номер последней версии зависимости). Пожалуйста, добавьте скрипты и конфигурационные записи для Jest:</p>
<pre><code class="hljs css language-json">// package.json
  "dependencies": {
    "react": "&lt;current-version&gt;",
    "react-dom": "&lt;current-version&gt;"
  },
  "devDependencies": {
    "@babel/preset-env": "&lt;current-version&gt;",
    "@babel/preset-react": "&lt;current-version&gt;",
    "babel-jest": "&lt;current-version&gt;",
    "jest": "&lt;current-version&gt;",
    "react-test-renderer": "&lt;current-version&gt;"
  },
  "scripts": {
    "test": "jest"
  }
</code></pre>
<pre><code class="hljs css language-js"><span class="hljs-comment">// babel.config.js</span>
<span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">presets</span>: [<span class="hljs-string">'@babel/preset-env'</span>, <span class="hljs-string">'@babel/preset-react'</span>],
};
</code></pre>
<p><strong>И все готово!</strong></p>
<h3><a class="anchor" aria-hidden="true" id="тестирование-при-помощи-снимков"></a><a href="#тестирование-при-помощи-снимков" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Тестирование при помощи снимков</h3>
<p>Создадим <a href="/docs/ru/26.0/snapshot-testing">тест использующий снимок</a> для компонента Link, который отображает гиперссылки:</p>
<pre><code class="hljs css language-tsx"><span class="hljs-comment">// Link.react.js</span>
<span class="hljs-keyword">import</span> React from <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">const</span> STATUS = {
  HOVERED: <span class="hljs-string">'hovered'</span>,
  NORMAL: <span class="hljs-string">'normal'</span>,
};

export <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Link</span> <span class="hljs-title">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>(props) {
    <span class="hljs-keyword">super</span>(props);

    <span class="hljs-keyword">this</span>._onMouseEnter = <span class="hljs-keyword">this</span>._onMouseEnter.bind(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">this</span>._onMouseLeave = <span class="hljs-keyword">this</span>._onMouseLeave.bind(<span class="hljs-keyword">this</span>);

    <span class="hljs-keyword">this</span>.state = {
      <span class="hljs-class"><span class="hljs-keyword">class</span>: <span class="hljs-type">STATUS.NORMAL</span>,
    <span class="hljs-type">};</span></span>
  }

  _onMouseEnter() {
    <span class="hljs-keyword">this</span>.setState({<span class="hljs-class"><span class="hljs-keyword">class</span>: <span class="hljs-type">STATUS.HOVERED});</span></span>
  }

  _onMouseLeave() {
    <span class="hljs-keyword">this</span>.setState({<span class="hljs-class"><span class="hljs-keyword">class</span>: <span class="hljs-type">STATUS.NORMAL});</span></span>
  }

  render() {
    <span class="hljs-keyword">return</span> (
      &lt;a
        className={<span class="hljs-keyword">this</span>.state<span class="hljs-class">.<span class="hljs-keyword">class</span>}</span>
        href={<span class="hljs-keyword">this</span>.props.page || <span class="hljs-string">'#'</span>}
        onMouseEnter={<span class="hljs-keyword">this</span>._onMouseEnter}
        onMouseLeave={<span class="hljs-keyword">this</span>._onMouseLeave}
      &gt;
        {<span class="hljs-keyword">this</span>.props.children}
      &lt;/a&gt;
    );
  }
}
</code></pre>
<p>Теперь используем рендерер тестов React и функции создания снимков Jest для взаимодействия с компонентом и захвата результата его отображения, а также создания файла снимка:</p>
<pre><code class="hljs css language-tsx"><span class="hljs-comment">// Link.react.test.js</span>
import React from 'react';
import renderer from 'react-test-renderer';
import Link from '../<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Link</span>.</span></span>react';

test('Link changes the <span class="hljs-keyword">class</span> <span class="hljs-keyword">when</span> hovered',<span class="hljs-function"> <span class="hljs-params">()</span> =&gt;</span> {
  const component = renderer.create(
    &lt;Link page=<span class="hljs-string">"http://www.facebook.com"</span>&gt;Facebook&lt;/Link&gt;,
  );
  <span class="hljs-keyword">let</span> tree = component.<span class="hljs-keyword">to</span><span class="hljs-constructor">JSON()</span>;
  expect(tree).<span class="hljs-keyword">to</span><span class="hljs-constructor">MatchSnapshot()</span>;

  <span class="hljs-comment">// manually trigger the callback</span>
  tree.props.on<span class="hljs-constructor">MouseEnter()</span>;
  <span class="hljs-comment">// re-rendering</span>
  tree = component.<span class="hljs-keyword">to</span><span class="hljs-constructor">JSON()</span>;
  expect(tree).<span class="hljs-keyword">to</span><span class="hljs-constructor">MatchSnapshot()</span>;

  <span class="hljs-comment">// manually trigger the callback</span>
  tree.props.on<span class="hljs-constructor">MouseLeave()</span>;
  <span class="hljs-comment">// re-rendering</span>
  tree = component.<span class="hljs-keyword">to</span><span class="hljs-constructor">JSON()</span>;
  expect(tree).<span class="hljs-keyword">to</span><span class="hljs-constructor">MatchSnapshot()</span>;
});
</code></pre>
<p>When you run <code>yarn test</code> or <code>jest</code>, this will produce an output file like this:</p>
<pre><code class="hljs css language-javascript"><span class="hljs-comment">// __tests__/__snapshots__/Link.react.test.js.snap</span>
exports[<span class="hljs-string">`Link changes the class when hovered 1`</span>] = <span class="hljs-string">`
&lt;a
  className="normal"
  href="http://www.facebook.com"
  onMouseEnter={[Function]}
  onMouseLeave={[Function]}&gt;
  Facebook
&lt;/a&gt;
`</span>;

exports[<span class="hljs-string">`Link changes the class when hovered 2`</span>] = <span class="hljs-string">`
&lt;a
  className="hovered"
  href="http://www.facebook.com"
  onMouseEnter={[Function]}
  onMouseLeave={[Function]}&gt;
  Facebook
&lt;/a&gt;
`</span>;

exports[<span class="hljs-string">`Link changes the class when hovered 3`</span>] = <span class="hljs-string">`
&lt;a
  className="normal"
  href="http://www.facebook.com"
  onMouseEnter={[Function]}
  onMouseLeave={[Function]}&gt;
  Facebook
&lt;/a&gt;
`</span>;
</code></pre>
<p>При следующем запуске тестов, отображаемый вывод будет сравнен с сохраненным снимком. The snapshot should be committed along with code changes. Когда тест использующий снимки проваливается, вам следует проверить предвиденные это изменения или нет. Если изменения предвиденные, то вы можете запустить Jest командой <code>jest -u</code> для перезаписи существующих снимков.</p>
<p>Код из этого примера доступен по адресу <a href="https://github.com/facebook/jest/tree/master/examples/snapshot">examples/snapshot</a>.</p>
<h4><a class="anchor" aria-hidden="true" id="snapshot-testing-with-mocks-enzyme-and-react-16"></a><a href="#snapshot-testing-with-mocks-enzyme-and-react-16" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Snapshot Testing with Mocks, Enzyme and React 16</h4>
<p>There's a caveat around snapshot testing when using Enzyme and React 16+. If you mock out a module using the following style:</p>
<pre><code class="hljs css language-js">jest.mock(<span class="hljs-string">'../SomeDirectory/SomeComponent'</span>, () =&gt; <span class="hljs-string">'SomeComponent'</span>);
</code></pre>
<p>Then you will see warnings in the console:</p>
<pre><code class="hljs css language-bash">Warning: &lt;SomeComponent /&gt; is using uppercase HTML. Always use lowercase HTML tags <span class="hljs-keyword">in</span> React.

<span class="hljs-comment"># Or:</span>
Warning: The tag &lt;SomeComponent&gt; is unrecognized <span class="hljs-keyword">in</span> this browser. If you meant to render a React component, start its name with an uppercase letter.
</code></pre>
<p>React 16 triggers these warnings due to how it checks element types, and the mocked module fails these checks. Your options are:</p>
<ol>
<li>Render as text. This way you won't see the props passed to the mock component in the snapshot, but it's straightforward:
<pre><code class="hljs css language-js">jest.mock(<span class="hljs-string">'./SomeComponent'</span>, () =&gt; <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-string">'SomeComponent'</span>);
</code></pre></li>
<li>Render as a custom element. DOM &quot;custom elements&quot; aren't checked for anything and shouldn't fire warnings. They are lowercase and have a dash in the name.
<pre><code class="hljs css language-tsx">jest.mock(<span class="hljs-string">'./Widget'</span>, <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> () =&gt; &lt;mock-widget /&gt;);
</code></pre></li>
<li>Use <code>react-test-renderer</code>. The test renderer doesn't care about element types and will happily accept e.g. <code>SomeComponent</code>. You could check snapshots using the test renderer, and check component behavior separately using Enzyme.</li>
<li>Disable warnings all together (should be done in your jest setup file):
<pre><code class="hljs css language-js">jest.mock(<span class="hljs-string">'fbjs/lib/warning'</span>, () =&gt; <span class="hljs-built_in">require</span>(<span class="hljs-string">'fbjs/lib/emptyFunction'</span>));
</code></pre>
This shouldn't normally be your option of choice as useful warnings could be lost. However, in some cases, for example when testing react-native's components we are rendering react-native tags into the DOM and many warnings are irrelevant. Another option is to swizzle the console.warn and suppress specific warnings.</li>
</ol>
<h3><a class="anchor" aria-hidden="true" id="тестирование-dom"></a><a href="#тестирование-dom" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Тестирование DOM</h3>
<p>If you'd like to assert, and manipulate your rendered components you can use <a href="https://github.com/kentcdodds/react-testing-library">react-testing-library</a>, <a href="http://airbnb.io/enzyme/">Enzyme</a>, or React's <a href="https://reactjs.org/docs/test-utils.html">TestUtils</a>. The following two examples use react-testing-library and Enzyme.</p>
<h4><a class="anchor" aria-hidden="true" id="react-testing-library"></a><a href="#react-testing-library" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>react-testing-library</h4>
<p>You have to run <code>yarn add --dev @testing-library/react</code> to use react-testing-library.</p>
<p>Let's implement a checkbox which swaps between two labels:</p>
<pre><code class="hljs css language-tsx"><span class="hljs-comment">// CheckboxWithLabel.js</span>

<span class="hljs-keyword">import</span> React from <span class="hljs-string">'react'</span>;

export <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CheckboxWithLabel</span> <span class="hljs-title">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>(props) {
    <span class="hljs-keyword">super</span>(props);
    <span class="hljs-keyword">this</span>.state = {isChecked: <span class="hljs-literal">false</span>};

    <span class="hljs-comment">// bind manually because React class components don't auto-bind</span>
    <span class="hljs-comment">// https://reactjs.org/blog/2015/01/27/react-v0.13.0-beta-1.html#autobinding</span>
    <span class="hljs-keyword">this</span>.onChange = <span class="hljs-keyword">this</span>.onChange.bind(<span class="hljs-keyword">this</span>);
  }

  onChange() {
    <span class="hljs-keyword">this</span>.setState({isChecked: !<span class="hljs-keyword">this</span>.state.isChecked});
  }

  render() {
    <span class="hljs-keyword">return</span> (
      &lt;label&gt;
        &lt;input
          type=<span class="hljs-string">"checkbox"</span>
          checked={<span class="hljs-keyword">this</span>.state.isChecked}
          onChange={<span class="hljs-keyword">this</span>.onChange}
        /&gt;
        {<span class="hljs-keyword">this</span>.state.isChecked ? <span class="hljs-keyword">this</span>.props.labelOn : <span class="hljs-keyword">this</span>.props.labelOff}
      &lt;/label&gt;
    );
  }
}
</code></pre>
<pre><code class="hljs css language-tsx"><span class="hljs-comment">// __tests__/CheckboxWithLabel-test.js</span>
import React from 'react';
import {cleanup, fireEvent, render} from '@testing-library/react';
import CheckboxWithLabel from '../CheckboxWithLabel';

<span class="hljs-comment">// Note: running cleanup afterEach is done automatically for you in @testing-library/react@9.0.0 or higher</span>
<span class="hljs-comment">// unmount and cleanup DOM after the test is finished.</span>
after<span class="hljs-constructor">Each(<span class="hljs-params">cleanup</span>)</span>;

it('CheckboxWithLabel changes the text after click',<span class="hljs-function"> <span class="hljs-params">()</span> =&gt;</span> {
  const {queryByLabelText, getByLabelText} = render(
    &lt;CheckboxWithLabel labelOn=<span class="hljs-string">"On"</span> labelOff=<span class="hljs-string">"Off"</span> /&gt;,
  );

  expect(query<span class="hljs-constructor">ByLabelText(<span class="hljs-operator">/</span><span class="hljs-params">off</span><span class="hljs-operator">/</span><span class="hljs-params">i</span>)</span>).<span class="hljs-keyword">to</span><span class="hljs-constructor">BeTruthy()</span>;

  fireEvent.click(get<span class="hljs-constructor">ByLabelText(<span class="hljs-operator">/</span><span class="hljs-params">off</span><span class="hljs-operator">/</span><span class="hljs-params">i</span>)</span>);

  expect(query<span class="hljs-constructor">ByLabelText(<span class="hljs-operator">/</span><span class="hljs-params">on</span><span class="hljs-operator">/</span><span class="hljs-params">i</span>)</span>).<span class="hljs-keyword">to</span><span class="hljs-constructor">BeTruthy()</span>;
});
</code></pre>
<p>The code for this example is available at <a href="https://github.com/facebook/jest/tree/master/examples/react-testing-library">examples/react-testing-library</a>.</p>
<h4><a class="anchor" aria-hidden="true" id="enzyme"></a><a href="#enzyme" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Enzyme</h4>
<p>You have to run <code>yarn add --dev enzyme</code> to use Enzyme. If you are using a React version below 15.5.0, you will also need to install <code>react-addons-test-utils</code>.</p>
<p>Let's rewrite the test from above using Enzyme instead of react-testing-library. В этом примере мы используем в <a href="http://airbnb.io/enzyme/docs/api/shallow.html">shallow renderer</a> включенный в Enzyme.</p>
<pre><code class="hljs css language-tsx"><span class="hljs-comment">// __tests__/CheckboxWithLabel-test.js</span>

<span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> {shallow} <span class="hljs-keyword">from</span> <span class="hljs-string">'enzyme'</span>;
<span class="hljs-keyword">import</span> CheckboxWithLabel <span class="hljs-keyword">from</span> <span class="hljs-string">'../CheckboxWithLabel'</span>;

test(<span class="hljs-string">'CheckboxWithLabel changes the text after click'</span>, <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-comment">// Render a checkbox with label in the document</span>
  <span class="hljs-keyword">const</span> checkbox = shallow(&lt;CheckboxWithLabel labelOn=<span class="hljs-string">"On"</span> labelOff=<span class="hljs-string">"Off"</span> /&gt;);

  expect(checkbox.text()).toEqual(<span class="hljs-string">'Off'</span>);

  checkbox.find(<span class="hljs-string">'input'</span>).simulate(<span class="hljs-string">'change'</span>);

  expect(checkbox.text()).toEqual(<span class="hljs-string">'On'</span>);
});
</code></pre>
<p>The code for this example is available at <a href="https://github.com/facebook/jest/tree/master/examples/enzyme">examples/enzyme</a>.</p>
<h3><a class="anchor" aria-hidden="true" id="пользовательские-трансформаторы"></a><a href="#пользовательские-трансформаторы" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Пользовательские трансформаторы</h3>
<p>If you need more advanced functionality, you can also build your own transformer. Instead of using babel-jest, here is an example of using babel:</p>
<pre><code class="hljs css language-javascript"><span class="hljs-comment">// custom-transformer.js</span>
<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">const</span> {transform} = <span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/core'</span>);
<span class="hljs-keyword">const</span> jestPreset = <span class="hljs-built_in">require</span>(<span class="hljs-string">'babel-preset-jest'</span>);

<span class="hljs-built_in">module</span>.exports = {
  process(src, filename) {
    <span class="hljs-keyword">const</span> result = transform(src, {
      filename,
      <span class="hljs-attr">presets</span>: [jestPreset],
    });

    <span class="hljs-keyword">return</span> result ? result.code : src;
  },
};
</code></pre>
<p>Don't forget to install the <code>@babel/core</code> and <code>babel-preset-jest</code> packages for this example to work.</p>
<p>Для использования с Jest, вам нужно будет добавить следующий код в вашу Jest конфигурацию: <code>&quot;transform&quot;: {&quot;\\.js$&quot;: &quot;path/to/custom-transformer.js&quot;}</code>.</p>
<p>Если потребуется создать трансформатор в поддержкой babel, то также можно использовать babel-jest для его композиции и передачи пользовательской конфигурации:</p>
<pre><code class="hljs css language-javascript"><span class="hljs-keyword">const</span> babelJest = <span class="hljs-built_in">require</span>(<span class="hljs-string">'babel-jest'</span>);

<span class="hljs-built_in">module</span>.exports = babelJest.createTransformer({
  <span class="hljs-attr">presets</span>: [<span class="hljs-string">'my-custom-preset'</span>],
});
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/ru/26.0/architecture"><span class="arrow-prev">← </span><span>Архитектура</span></a><a class="docs-next button" href="/docs/ru/26.0/tutorial-react-native"><span>Testing React Native Apps</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#настройка">Настройка</a><ul class="toc-headings"><li><a href="#настройка-с-create-react-app">Настройка с Create React App</a></li><li><a href="#настройка-без-create-react-app">Настройка без Create React App</a></li><li><a href="#тестирование-при-помощи-снимков">Тестирование при помощи снимков</a></li><li><a href="#тестирование-dom">Тестирование DOM</a></li><li><a href="#пользовательские-трансформаторы">Пользовательские трансформаторы</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/jest-outline.svg" alt="Jest" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/ru/getting-started.html">Getting Started</a><a href="/docs/ru/snapshot-testing.html">Guides</a><a href="/docs/ru/api.html">API Reference</a></div><div><h5>Community</h5><a href="https://stackoverflow.com/questions/tagged/jestjs" target="_blank">Stack Overflow</a><a href="https://www.reactiflux.com/">Reactiflux</a><a href="https://twitter.com/fbjest" target="_blank">Twitter</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="https://github.com/facebook/jest">GitHub</a><a class="github-button" href="https://github.com/facebook/jest" data-icon="octicon-star" data-count-href="/facebook/jest/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star facebook/jest on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2020 Facebook Inc.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src='https://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, 'script', 'twitter-wjs'));</script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '833906d7486e4059359fa58823c4ef56',
                indexName: 'jest',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:ru","version:26.0"]}
              });
            </script></body></html>