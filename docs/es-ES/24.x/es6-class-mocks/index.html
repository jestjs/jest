<!DOCTYPE html><html lang="es-ES"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>ES6 Class Mocks · Jest</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Jest se puede utilizar para crear mocks que simulan clases de ES6 que importan a los archivos que deseas probar."/><meta name="docsearch:version" content="24.x"/><meta name="docsearch:language" content="es-ES"/><meta property="og:title" content="ES6 Class Mocks · Jest"/><meta property="og:type" content="website"/><meta property="og:url" content="https://jestjs.io/"/><meta property="og:description" content="Jest se puede utilizar para crear mocks que simulan clases de ES6 que importan a los archivos que deseas probar."/><meta property="og:image" content="https://jestjs.io/img/opengraph.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://jestjs.io/img/jest.png"/><link rel="shortcut icon" href="/img/favicon/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://jestjs.io/blog/atom.xml" title="Jest Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://jestjs.io/blog/feed.xml" title="Jest Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-44373548-17', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="/css/code-block-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/es-ES"><img class="logo" src="/img/jest.svg" alt="Jest"/><h2 class="headerTitleWithLogo">Jest</h2></a><a href="/es-ES/versions"><h3>24.x</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/es-ES/24.x/getting-started" target="_self">Documentación</a></li><li class="siteNavGroupActive"><a href="/docs/es-ES/24.x/api" target="_self">API</a></li><li class=""><a href="/es-ES/help" target="_self">Ayuda</a></li><li class=""><a href="/blog/" target="_self">Blog</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>Español</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/en/24.x/es6-class-mocks">English</a></li><li><a href="/docs/ja/24.x/es6-class-mocks">日本語</a></li><li><a href="/docs/pt-BR/24.x/es6-class-mocks">Português (Brasil)</a></li><li><a href="/docs/ro/24.x/es6-class-mocks">Română</a></li><li><a href="/docs/ru/24.x/es6-class-mocks">Русский</a></li><li><a href="/docs/uk/24.x/es6-class-mocks">Українська</a></li><li><a href="/docs/zh-Hans/24.x/es6-class-mocks">简体中文</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="https://github.com/facebook/jest" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Guides</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Introduction</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/getting-started">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/using-matchers">Using Matchers</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/asynchronous">Testing Asynchronous Code</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/setup-teardown">Setup and Teardown</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/mock-functions">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/jest-platform">Jest Platform</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/jest-community">Jest Community</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/more-resources">More Resources</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Guides</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/snapshot-testing">Snapshot Testing</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/tutorial-async">An Async Example</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/timer-mocks">Timer Mocks</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/manual-mocks">Manual Mocks</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/es-ES/24.x/es6-class-mocks">ES6 Class Mocks</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/bypassing-module-mocks">Bypassing module mocks</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/webpack">Using with webpack</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/puppeteer">Using with puppeteer</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/mongodb">Using with MongoDB</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/dynamodb">Using with DynamoDB</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/tutorial-jquery">DOM Manipulation</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/watch-plugins">Watch Plugins</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/migration-guide">Migrating to Jest</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/troubleshooting">Troubleshooting</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/architecture">Architecture</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Framework Guides</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/tutorial-react">Testing React Apps</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/tutorial-react-native">Testing React Native Apps</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/testing-frameworks">Testing Web Frameworks</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">API Reference</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/api">Globals</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/expect">Expect</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/mock-function-api">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/jest-object">The Jest Object</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/configuration">Configuring Jest</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/cli">Jest CLI Options</a></li><li class="navListItem"><a class="navItem" href="/docs/es-ES/24.x/environment-variables">Environment Variables</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/facebook/jest/edit/master/docs/Es6ClassMocks.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">ES6 Class Mocks</h1></header><article><div><span><p>Jest se puede utilizar para crear mocks que simulan clases de ES6 que importan a los archivos que deseas probar.</p>
<p>Las clases de ES6 son funciones constructor con un poco de sintaxis adicional. Por lo tanto, cualquier mock para una clase ES6 debe ser una función o una clase ES6 actual (que es, de nuevo, otra función). Entonces puedes hacer un mock usando <a href="/docs/es-ES/24.x/mock-functions">funciones mock</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="un-ejemplo-de-clase-es6"></a><a href="#un-ejemplo-de-clase-es6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Un ejemplo de clase ES6</h2>
<p>Usaremos un ejemplo de una clase que reproduce archivos de sonido,<code>Reproductor</code> y una clase de consumidores que una esa clase,<code>Consumidor</code>. Crearemos un mock de <code>Reproductor</code> en nuestros test de <code>Consumidor</code>.</p>
<pre><code class="hljs css language-javascript"><span class="hljs-comment">// reproductor.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Reproductor</span></span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.variableEjemplo = <span class="hljs-string">'valorEjemplo'</span>;
  }

  reproducirArchivoDeSonido(nombreDeArchivo) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Reproduciendo archivo de sonido '</span> + nombreDeArchivo);
  }
}
</code></pre>
<pre><code class="hljs css language-javascript"><span class="hljs-comment">// consumidor.js</span>
<span class="hljs-keyword">import</span> Reproductor <span class="hljs-keyword">from</span> <span class="hljs-string">'./reproductor'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Consumidor</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.reproductor = <span class="hljs-keyword">new</span> Reproductor();
  }

  reproduceAlgoCool() {
    <span class="hljs-keyword">const</span> nombreDeArchivoCool = <span class="hljs-string">'cancion.mp3'</span>;
    <span class="hljs-keyword">this</span>.reproductor.reproducirArchivoDeSonido(nombreDeArchivoCool);
  }
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="las-4-formas-de-crear-una-clase-mock-es6"></a><a href="#las-4-formas-de-crear-una-clase-mock-es6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Las 4 formas de crear una clase mock ES6</h2>
<h3><a class="anchor" aria-hidden="true" id="mocks-automáticos"></a><a href="#mocks-automáticos" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mocks automáticos</h3>
<p><code>jest.mock('./reproductor')</code> regresa un mock automático que se puede ocupar para espiar llamadas al constructor de la clase y todos sus métodos. Este reemplaza la clase ES6 con un constructor mock, y reemplaza todos sus métodos con <a href="/docs/es-ES/24.x/mock-functions">funciones mock</a> que siempre regresan <code>undefined</code>. Las llamadas a los métodos se almacenan en <code>elMockAutomatico.mock.instances[índice].nombreDelMetodo.mock.calls</code>.</p>
<p>Ten en cuenta que si utilizas funciones de flecha (=&gt;) en tus clases, estas <em>NO</em> serán parte del mock. Esto es porque las funciones flecha no están presentes en el prototipo del objeto, son simplemente propiedades que contienen una referencia a una función.</p>
<p>If you don't need to replace the implementation of the class, this is the easiest option to set up. Por ejemplo:</p>
<pre><code class="hljs css language-javascript"><span class="hljs-keyword">import</span> Reproductor <span class="hljs-keyword">from</span> <span class="hljs-string">'./reproductor'</span>;
<span class="hljs-keyword">import</span> Consumidor <span class="hljs-keyword">from</span> <span class="hljs-string">'./consumidor'</span>;
jest.mock(<span class="hljs-string">'./reproductor'</span>); <span class="hljs-comment">// Reproductor es ahora un constructor mock</span>

beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-comment">// Borra todas las instancias y llamadas al constructor y a todos los métodos:</span>
  Reproductor.mockClear();
});

it(<span class="hljs-string">'Podemos verificar que el consumidor llamó al constructor de la clase'</span>, () =&gt; {
  <span class="hljs-keyword">const</span> consumidor = <span class="hljs-keyword">new</span> Consumidor();
  expect(Reproductor).toHaveBeenCalledTimes(<span class="hljs-number">1</span>);
});

it(<span class="hljs-string">'Podemos verificar que el consumidor llamó a algún método de la instancia'</span>, () =&gt; {
  <span class="hljs-comment">// Muestra que mockClear() está funcionando:</span>
  expect(Reproductor).not.toHaveBeenCalled();

  <span class="hljs-keyword">const</span> consumidor = <span class="hljs-keyword">new</span> Consumidor();
  <span class="hljs-comment">// Constructor debió haber sido llamado nuevamente:</span>
  expect(Reproductor).toHaveBeenCalledTimes(<span class="hljs-number">1</span>);

  <span class="hljs-keyword">const</span> nombreDeArchivoCool = <span class="hljs-string">'cancion.mp3'</span>;
  consumidor.reproduceAlgoCool();

  <span class="hljs-comment">// mock.instances esta disponible con mocks automáticos:</span>
  <span class="hljs-keyword">const</span> instanciaMockDeReproductor= Reproductor.mock.instances[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">const</span> mockDeReproducirArchivoDeSonido = instanciaMockDeReproductor.reproducirArchivoDeSonido;
  expect(mockDeReproducirArchivoDeSonido.mock.calls[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]).toEqual(nombreDeArchivoCool);
  <span class="hljs-comment">// Equivalente a la verificación anterior:</span>
  expect(mockDeReproducirArchivoDeSonido).toHaveBeenCalledWith(nombreDeArchivoCool);
  expect(mockDeReproducirArchivoDeSonido).toHaveBeenCalledTimes(<span class="hljs-number">1</span>);
});
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="mock-manual"></a><a href="#mock-manual" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mock Manual</h3>
<p>Crea un <a href="/docs/es-ES/24.x/manual-mocks">mock manual</a> almacenando una implementación mock en la carpeta <code>__mocks__</code>. Esto te permite especificar la implementación, y puede ser utilizada a través de varios archivos de test.</p>
<pre><code class="hljs css language-javascript"><span class="hljs-comment">// __mocks__/reproductor.js</span>

<span class="hljs-comment">// Importa esta exportación nombrada en tu archivo test:</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> mockDeReproducirArchivoDeSonido = jest.fn();
<span class="hljs-keyword">const</span> mock = jest.fn().mockImplementation(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-keyword">return</span> {<span class="hljs-attr">reproducirArchivoDeSonido</span>: mockDeReproducirArchivoDeSonido};
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> mock;
</code></pre>
<p>Importa la simulación y el método de simulación compartido por todas las instancias:</p>
<pre><code class="hljs css language-javascript"><span class="hljs-comment">// consumidor.test.js</span>
<span class="hljs-keyword">import</span> Reproductor, {mockReproducirArchivoDeSonido} <span class="hljs-keyword">from</span> <span class="hljs-string">'./reproductor'</span>;
<span class="hljs-keyword">import</span> Consumidor <span class="hljs-keyword">from</span> <span class="hljs-string">'./consumidor'</span>;
jest.mock(<span class="hljs-string">'./reproductor'</span>); <span class="hljs-comment">// Reproductor es ahora un constructor mock</span>

beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-comment">// Borra todas las instancias y llamadas al constructor y a todos los métodos:</span>
  Reproductor.mockClear();
  mockReproducirArchivoDeSonido.mockClear();
});

it(<span class="hljs-string">'Podemos verificar que el consumidor llamó al constructor de la clase'</span>, () =&gt; {
  <span class="hljs-keyword">const</span> consumidor = <span class="hljs-keyword">new</span> Consumidor();
  expect(Reproductor).toHaveBeenCalledTimes(<span class="hljs-number">1</span>);
});

it(<span class="hljs-string">'Podemos verificar que el consumidor llamó a algún método de la instancia'</span>, () =&gt; {
  <span class="hljs-keyword">const</span> consumidor = <span class="hljs-keyword">new</span> Consumidor();
  <span class="hljs-keyword">const</span> nombreDeArchivoCool = <span class="hljs-string">'cancion.mp3'</span>;
  consumidor.reproduceAlgoCool();
  expect(mockDeReproducirArchivoDeSonido).toHaveBeenCalledWith(nombreDeArchivoCool);
});
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="llamando-jestmockdocses-es24xjest-objectjestmockmodulename-factory-options-con-el-parámetro-de-fábrica-de-módulo"></a><a href="#llamando-jestmockdocses-es24xjest-objectjestmockmodulename-factory-options-con-el-parámetro-de-fábrica-de-módulo" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Llamando <a href="/docs/es-ES/24.x/jest-object#jestmockmodulename-factory-options"><code>jest.mock()</code></a> con el parámetro de fábrica de módulo</h3>
<p><code>jest.mock(path, moduleFactory)</code> takes a <strong>module factory</strong> argument. A module factory is a function that returns the mock.</p>
<p>Para crear un mock de una función constructor, la fábrica de módulo debe regresar una función constructor. En otras palabras, la fábrica de módulo debe ser una función que regresa una función - una función de alto orden, o HOF, por sus siglas en inglés (Higher-Order Function).</p>
<pre><code class="hljs css language-javascript"><span class="hljs-keyword">import</span> Reproductor <span class="hljs-keyword">from</span> <span class="hljs-string">'./reproductor'</span>;
<span class="hljs-keyword">const</span> mockReproducirArchivoDeSonido = jest.fn();
jest.mock(<span class="hljs-string">'./reproductor'</span>, () =&gt; {
  <span class="hljs-keyword">return</span> jest.fn().mockImplementation(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> {<span class="hljs-attr">reproducirArchivoDeSonido</span>: mockReproducirArchivoDeSonido};
  });
});
</code></pre>
<p>Una limitación el argumento fábrica de modulo es que, ya que las llamadas a <code>jest.mock()</code> son elevadas hasta el inicio del archivo, no es posible definir una variable y luego usarla en la fábrica. Se hace un excepción para variables que empiecen con la palabra 'mock'. ¡Depende de ti garantizar de que serán inicializadas a tiempo! Por ejemplo, lo siguiente arrojará un error fuera de alcance (out-of-scope) debido al uso de 'fake' en lugar de 'mock' en la declaración de la variable:</p>
<pre><code class="hljs css language-javascript">// Nota: esto fallará
import Reproductor de './reproductor';
const fakeReproducirArchivoDeSonido = jest.fn();
jest.mock('./reproductor, () =&gt; {
  return jest.fn().mockImplementation(() =&gt; {
    return {reproducirArchivoDeSonido: fakeReproducirArchivoDeSonido };
  });
});
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="sustituir-el-mock-utilizando-mockimplementationdocses-es24xmock-function-apimockfnmockimplementationfn-o-mockimplementationoncedocses-es24xmock-function-apimockfnmockimplementationoncefn"></a><a href="#sustituir-el-mock-utilizando-mockimplementationdocses-es24xmock-function-apimockfnmockimplementationfn-o-mockimplementationoncedocses-es24xmock-function-apimockfnmockimplementationoncefn" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sustituir el mock utilizando <a href="/docs/es-ES/24.x/mock-function-api#mockfnmockimplementationfn"><code>mockImplementation()</code></a> o <a href="/docs/es-ES/24.x/mock-function-api#mockfnmockimplementationoncefn"><code>mockImplementationOnce()</code></a></h3>
<p>Puedes reemplazar todos los mocks anteriores para cambiar la implementación, para uno así como para todos los test, al llamar <code>mockImplementation()</code> en el mock existente.</p>
<p>Las llamadas a jest.mock son elevadas al principio del código. Puedes especificar una mock posteriormente, por ejemplo, en <code>beforeAll()</code>, al llamar <code>mockImplementation()</code> (o <code>mockImplementationOnce()</code>) en el mock existente en lugar de usar el parámetro de fábrica. Esto también le permite cambiar la simulación entre pruebas, si se necesita:</p>
<pre><code class="hljs css language-javascript"><span class="hljs-keyword">import</span> Reproductor de <span class="hljs-string">'./reproductor'</span>;
<span class="hljs-keyword">import</span> Consumidor de <span class="hljs-string">'./consumidor'</span>;

jest.mock(<span class="hljs-string">'./reproductor'</span>);

describe(<span class="hljs-string">'Cuando Reproductor arroja un error'</span>, () =&gt; {
  beforeAll(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    Reproductor.mockImplementation(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">reproducirArchivoDeSonido</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Error de prueba'</span>);
        },
      };
    });
  });

  it(<span class="hljs-string">'Debería arrojar un error al llamar a reproduceAlgoCool'</span>, () =&gt; {
    <span class="hljs-keyword">const</span> consumidor = <span class="hljs-keyword">new</span> consumidor();
    expect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> consumidor.reproduceAlgoCool()).toThrow();
  });
});
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="a-profundidad-entendiendo-las-funciones-constructor-mock"></a><a href="#a-profundidad-entendiendo-las-funciones-constructor-mock" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>A profundidad: Entendiendo las funciones constructor mock</h2>
<p>Construir tus funciones de constructor de mock utilizando <code>jest.fn().mockImplementation()</code> hace que los mock se vean más complicados de lo que en realidad son. Esta sección muestra cómo puedes crear tus propios mock para ilustrar cómo funciona el simular módulos con mocks.</p>
<h3><a class="anchor" aria-hidden="true" id="mock-manual-de-otra-clase-es6"></a><a href="#mock-manual-de-otra-clase-es6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mock manual de otra clase ES6</h3>
<p>Si defines una clase ES6 utilizando el mismo nombre de archivo que la clase mock en la carpeta <code>__mocks__</code>, éste servirá como el mock. Esta clase será utilizada en lugar de la clase real. Esto te permite inyectar una implementación de prueba para la clase, pero no proporciona una forma de espiar las llamadas.</p>
<p>Para un ejemplo ideado, la proyección podría verse así:</p>
<pre><code class="hljs css language-javascript"><span class="hljs-comment">// __mocks__/sound-player.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SoundPlayer</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Mock SoundPlayer: constructor was called'</span>);
  }

  playSoundFile() {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Mock SoundPlayer: playSoundFile was called'</span>);
  }
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="mock-simple-utilizando-un-parámetro-de-fábrica-de-módulo"></a><a href="#mock-simple-utilizando-un-parámetro-de-fábrica-de-módulo" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mock simple utilizando un parámetro de fábrica de módulo</h3>
<p>La función de fábrica de módulo pasada a <code>jest.mock(ruta, fabricaDeModulo)</code> puede ser una función de alto orden que regresa una función*. Esto permitirá llamar a <code>new</code> en la simulación. De nuevo, esto te permite inyectar un comportamiento diferente para las pruebas, pero no proporciona una forma de espiar llamadas.</p>
<h4><a class="anchor" aria-hidden="true" id="-la-función-de-fábrica-del-módulo-debe-devolver-una-función"></a><a href="#-la-función-de-fábrica-del-módulo-debe-devolver-una-función" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>* La función de fábrica del módulo debe devolver una función</h4>
<p>Para crear un mock de una función constructor, la fábrica de módulo debe regresar una función constructor. En otras palabras, la fábrica de módulo debe ser una función que regresa una función - una función de alto orden, o HOF, por sus siglas en inglés (Higher-Order Function).</p>
<pre><code class="hljs css language-javascript">jest.mock(<span class="hljs-string">'./reproductor'</span>, () =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> {<span class="hljs-attr">reproducirArchivoDeSonido</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {}};
  };
});
</code></pre>
<p><strong><em>Nota: las funciones de flecha no funcionaran</em></strong></p>
<p>Note that the mock can't be an arrow function because calling <code>new</code> on an arrow function is not allowed in JavaScript. So this won't work:</p>
<pre><code class="hljs css language-javascript">jest.mock(<span class="hljs-string">'./sound-player'</span>, () =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Does not work; arrow functions can't be called with new</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-attr">playSoundFile</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {}};
  };
});
</code></pre>
<p>Esto arrojará <strong><em>TypeError: _soundPlayer.default is not a constructor</em></strong> (Error de tipo: soundPlayer.default no es un constructor), a menos que el código sea transpilado a ES5, por ejemplo por <code>@babel/preset-env</code>. (ES5 no tiene funciones de flecha ni clases, por lo que ambas serán transpiladas a funciones simples.)</p>
<h2><a class="anchor" aria-hidden="true" id="haciendo-seguimiento-del-uso-espiando-al-mock"></a><a href="#haciendo-seguimiento-del-uso-espiando-al-mock" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Haciendo seguimiento del uso (espiando al mock)</h2>
<p>Inyectar una implementación de prueba es útil, pero probablemente desearás probar si el constructor de clase y los métodos están siendo llamados con los parámetros correctos.</p>
<h3><a class="anchor" aria-hidden="true" id="espiando-al-constructor"></a><a href="#espiando-al-constructor" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Espiando al constructor</h3>
<p>Para rastrear llamadas al constructor, reemplaza la función devuelta por la función de alto orden con una función de mock de Jest. Créalo con <a href="/docs/es-ES/24.x/jest-object#jestfnimplementation"><code>jest.fn()</code></a>, y luego especifica su implementación con <code>mockImplementation()</code>.</p>
<pre><code class="hljs css language-javascript"><span class="hljs-keyword">import</span> SoundPlayer <span class="hljs-keyword">from</span> <span class="hljs-string">'./sound-player'</span>;
jest.mock(<span class="hljs-string">'./sound-player'</span>, () =&gt; {
  <span class="hljs-comment">// Works and lets you check for constructor calls:</span>
  <span class="hljs-keyword">return</span> jest.fn().mockImplementation(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> {<span class="hljs-attr">playSoundFile</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {}};
  });
});
</code></pre>
<p>Esto nos permitirá inspeccionar el uso de nuestra clase mock, utilizando <code>Reproductor.mock.calls</code>: <code>expect(Reproductor).toHaveBeenCalled();</code> o su equivalente cercano <code>expect(Reproductor.mock.calls.length).toEqual(1);</code></p>
<h3><a class="anchor" aria-hidden="true" id="creando-mocks-para-exports-no-default"></a><a href="#creando-mocks-para-exports-no-default" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creando mocks para exports no default</h3>
<p>If the class is <strong>not</strong> the default export from the module then you need to return an object with the key that is the same as the class export name.</p>
<pre><code class="hljs css language-javascript"><span class="hljs-keyword">import</span> {Reproductor} <span class="hljs-keyword">from</span> <span class="hljs-string">'./reproductor'</span>;
jest.mock(<span class="hljs-string">'./reproductor'</span>, () =&gt; {
  <span class="hljs-comment">// Funciona y te permite verificar llamadas al constructor:</span>
 <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">Reproductor</span>: jest.fn().mockImplementation(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">return</span> {<span class="hljs-attr">reproducirArchivoDeSonido</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {}};
    }),
  };
});
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="espiando-métodos-de-nuestra-clase"></a><a href="#espiando-métodos-de-nuestra-clase" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Espiando métodos de nuestra clase</h3>
<p>Nuestra clase simulada necesitará proporcionar cualquier función miembro (<code>playSoundFile</code> en el ejemplo) que será llamada durante nuestras pruebas, o bien obtendremos un error por llamar una función que no existe. Pero probablemente querramos tambien espiar llamadas a esos métodos, para asegurar de que fueron llamados con los parámetros esperados.</p>
<p>Un nuevo objeto será creado cada vez que la simulación de la función constructora sea llamada durante las pruebas. Para espiar llamadas de método en todos estos objetos, poblamos <code>playSoundFile</code> con otra función de simulación, y almacenamos una referencia para esa misma función de simulación en nuestro archivo de prueba, para que esté disponible durante las pruebas.</p>
<pre><code class="hljs css language-javascript"><span class="hljs-keyword">import</span> SoundPlayer <span class="hljs-keyword">from</span> <span class="hljs-string">'./sound-player'</span>;
<span class="hljs-keyword">const</span> mockPlaySoundFile = jest.fn();
jest.mock(<span class="hljs-string">'./sound-player'</span>, () =&gt; {
  <span class="hljs-keyword">return</span> jest.fn().mockImplementation(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> {<span class="hljs-attr">playSoundFile</span>: mockPlaySoundFile};
    <span class="hljs-comment">// Now we can track calls to playSoundFile</span>
  });
});
</code></pre>
<p>El equivalente de simulación manual de esto sería:</p>
<pre><code class="hljs css language-javascript"><span class="hljs-comment">// __mocks__/sound-player.js</span>

<span class="hljs-comment">// Import this named export into your test file</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> mockPlaySoundFile = jest.fn();
<span class="hljs-keyword">const</span> mock = jest.fn().mockImplementation(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-keyword">return</span> {<span class="hljs-attr">playSoundFile</span>: mockPlaySoundFile};
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> mock;
</code></pre>
<p>El uso es similar a la función de fábrica del módulo, sólo que puede omitir el segundo argumento de <code>jest.mock()</code>, y deberá importar el método simulado a su archivo de prueba, puesto que ya no es definido ahí. Utilice la ruta de módulo original para esto; no incluya <code>__mocks__</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="limpiando-entre-pruebas"></a><a href="#limpiando-entre-pruebas" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Limpiando entre pruebas</h3>
<p>Para vaciar el registro de llamadas a la función constructura de simulaciones y sus métodos, llamamos a <a href="/docs/es-ES/24.x/mock-function-api#mockfnmockclear"><code>mockClear()</code></a> en la función <code>beforeEach()</code>:</p>
<pre><code class="hljs css language-javascript">beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  SoundPlayer.mockClear();
  mockPlaySoundFile.mockClear();
});
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="ejemplo-completo"></a><a href="#ejemplo-completo" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ejemplo completo</h2>
<p>Aquí tiene un archivo de prueba completo el cual utiliza un parámetro de fábrica de módulos para <code>jest.mock</code>:</p>
<pre><code class="hljs css language-javascript"><span class="hljs-comment">// sound-player-consumer.test.js</span>
<span class="hljs-keyword">import</span> SoundPlayer <span class="hljs-keyword">from</span> <span class="hljs-string">'./sound-player'</span>;
<span class="hljs-keyword">import</span> SoundPlayerConsumer <span class="hljs-keyword">from</span> <span class="hljs-string">'./sound-player-consumer'</span>;

<span class="hljs-keyword">const</span> mockPlaySoundFile = jest.fn();
jest.mock(<span class="hljs-string">'./sound-player'</span>, () =&gt; {
  <span class="hljs-keyword">return</span> jest.fn().mockImplementation(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> {<span class="hljs-attr">playSoundFile</span>: mockPlaySoundFile};
  });
});

beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  SoundPlayer.mockClear();
  mockPlaySoundFile.mockClear();
});

it(<span class="hljs-string">'The consumer should be able to call new() on SoundPlayer'</span>, () =&gt; {
  <span class="hljs-keyword">const</span> soundPlayerConsumer = <span class="hljs-keyword">new</span> SoundPlayerConsumer();
  <span class="hljs-comment">// Ensure constructor created the object:</span>
  expect(soundPlayerConsumer).toBeTruthy();
});

it(<span class="hljs-string">'We can check if the consumer called the class constructor'</span>, () =&gt; {
  <span class="hljs-keyword">const</span> soundPlayerConsumer = <span class="hljs-keyword">new</span> SoundPlayerConsumer();
  expect(SoundPlayer).toHaveBeenCalledTimes(<span class="hljs-number">1</span>);
});

it(<span class="hljs-string">'We can check if the consumer called a method on the class instance'</span>, () =&gt; {
  <span class="hljs-keyword">const</span> soundPlayerConsumer = <span class="hljs-keyword">new</span> SoundPlayerConsumer();
  <span class="hljs-keyword">const</span> coolSoundFileName = <span class="hljs-string">'song.mp3'</span>;
  soundPlayerConsumer.playSomethingCool();
  expect(mockPlaySoundFile.mock.calls[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]).toEqual(coolSoundFileName);
});
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/es-ES/24.x/manual-mocks"><span class="arrow-prev">← </span><span>Manual Mocks</span></a><a class="docs-next button" href="/docs/es-ES/24.x/bypassing-module-mocks"><span>Evitar mocks de módulos</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#un-ejemplo-de-clase-es6">Un ejemplo de clase ES6</a></li><li><a href="#las-4-formas-de-crear-una-clase-mock-es6">Las 4 formas de crear una clase mock ES6</a><ul class="toc-headings"><li><a href="#mocks-automáticos">Mocks automáticos</a></li><li><a href="#mock-manual">Mock Manual</a></li><li><a href="#llamando-jestmockdocses-es24xjest-objectjestmockmodulename-factory-options-con-el-parámetro-de-fábrica-de-módulo">Llamando <a href="/docs/es-ES/24.x/jest-object#jestmockmodulename-factory-options"><code>jest.mock()</code></a> con el parámetro de fábrica de módulo</a></li><li><a href="#sustituir-el-mock-utilizando-mockimplementationdocses-es24xmock-function-apimockfnmockimplementationfn-o-mockimplementationoncedocses-es24xmock-function-apimockfnmockimplementationoncefn">Sustituir el mock utilizando <a href="/docs/es-ES/24.x/mock-function-api#mockfnmockimplementationfn"><code>mockImplementation()</code></a> o <a href="/docs/es-ES/24.x/mock-function-api#mockfnmockimplementationoncefn"><code>mockImplementationOnce()</code></a></a></li></ul></li><li><a href="#a-profundidad-entendiendo-las-funciones-constructor-mock">A profundidad: Entendiendo las funciones constructor mock</a><ul class="toc-headings"><li><a href="#mock-manual-de-otra-clase-es6">Mock manual de otra clase ES6</a></li><li><a href="#mock-simple-utilizando-un-parámetro-de-fábrica-de-módulo">Mock simple utilizando un parámetro de fábrica de módulo</a></li></ul></li><li><a href="#haciendo-seguimiento-del-uso-espiando-al-mock">Haciendo seguimiento del uso (espiando al mock)</a><ul class="toc-headings"><li><a href="#espiando-al-constructor">Espiando al constructor</a></li><li><a href="#creando-mocks-para-exports-no-default">Creando mocks para exports no default</a></li><li><a href="#espiando-métodos-de-nuestra-clase">Espiando métodos de nuestra clase</a></li><li><a href="#limpiando-entre-pruebas">Limpiando entre pruebas</a></li></ul></li><li><a href="#ejemplo-completo">Ejemplo completo</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/jest-outline.svg" alt="Jest" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/es-ES/getting-started.html">Getting Started</a><a href="/docs/es-ES/snapshot-testing.html">Guides</a><a href="/docs/es-ES/api.html">API Reference</a></div><div><h5>Community</h5><a href="https://stackoverflow.com/questions/tagged/jestjs" target="_blank">Stack Overflow</a><a href="https://discord.gg/j6FKKQQrW9">Reactiflux</a><a href="https://twitter.com/fbjest" target="_blank">Twitter</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="https://github.com/facebook/jest">GitHub</a><a class="github-button" href="https://github.com/facebook/jest" data-icon="octicon-star" data-count-href="/facebook/jest/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star facebook/jest on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2020 Facebook Inc.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src='https://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, 'script', 'twitter-wjs'));</script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '833906d7486e4059359fa58823c4ef56',
                indexName: 'jest',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:es-ES","version:24.x"]}
              });
            </script></body></html>