<html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"/><title>Testing React Native Apps · Jest</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Testing React Native Apps · Jest"/><meta property="og:type" content="website"/><meta property="og:url" content="https://facebook.github.io/jest/index.html"/><meta property="og:description" content="No Facebook, nós usamos Jest para testar aplicações [React Native](http://facebook.github.io/react-native/)."/><meta property="og:image" content="/jest/img/opengraph.png"/><link rel="shortcut icon" href="/jest/img/favicon/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="/jest/css/main.css"/><link rel="alternate" type="application/atom+xml" href="https://facebook.github.io/blog/atom.xml" title="Jest Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://facebook.github.io/blog/feed.xml" title="Jest Blog RSS Feed"/><script async="" defer="" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/jest/"><img class="logo" src="/jest/img/jest.svg"/><h2 class="headerTitle">Jest</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/jest/docs/pt-BR/getting-started.html" target="_self">Documentação</a></li><li><a href="/jest/docs/pt-BR/api.html" target="_self">API</a></li><li><a href="/jest/pt-BR/help.html" target="_self">Ajuda</a></li><li><a href="/jest/blog" target="_self">Blog</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/jest/img/language.svg"/>Português (Brasil)</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/jest/en">English</a></li><li><a href="/jest/ja">日本語</a></li><li><a href="/jest/es-ES">Español</a></li><li><a href="/jest/ro">Română</a></li><li><a href="/jest/ru">Русский</a></li><li><a href="/jest/uk">Українська</a></li><li><a href="/jest/zh-Hans">简体中文</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(){
          if(languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search"/></li><li><a href="https://github.com/facebook/jest" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Framework Guides</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Introduction</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/getting-started.html">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/using-matchers.html">Using Matchers</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/asynchronous.html">Testing Asynchronous Code</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/setup-teardown.html">Setup and Teardown</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/mock-functions.html">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/more-resources.html">More Resources</a></li></ul></div><div class="navGroup navGroupActive"><h3>API Reference</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/api.html">Globals</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/expect.html">Expect</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/mock-function-api.html">Mock Functions</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/jest-object.html">The Jest Object</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/configuration.html">Configuring Jest</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/cli.html">Jest CLI Options</a></li></ul></div><div class="navGroup navGroupActive"><h3>Framework Guides</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/tutorial-react.html">Testing React Apps</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/jest/docs/pt-BR/tutorial-react-native.html">Testing React Native Apps</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/testing-frameworks.html">Testing Web Frameworks</a></li></ul></div><div class="navGroup navGroupActive"><h3>Guides</h3><ul><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/snapshot-testing.html">Teste de Snapshot</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/tutorial-async.html">An Async Example</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/timer-mocks.html">Timer Mocks</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/manual-mocks.html">Manual Mocks</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/webpack.html">Using with webpack</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/migration-guide.html">Migrating to Jest</a></li><li class="navListItem"><a class="navItem" href="/jest/docs/pt-BR/troubleshooting.html">Troubleshooting</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1>Testing React Native Apps</h1></header><article><div><span><p>No Facebook, nós usamos Jest para testar aplicações <a href="http://facebook.github.io/react-native/">React Native</a>.</p>
<p>Obtenha uma visão mais profunda em como testar um app React Native de exemplo lendo a seguinte série: <a href="https://blog.callstack.io/unit-testing-react-native-with-the-new-jest-i-snapshots-come-into-play-68ba19b1b9fe#.12zbnbgwc">Parte 1: Jest – Snapshot entra em jogo (em inglês)</a> e <a href="https://blog.callstack.io/unit-testing-react-native-with-the-new-jest-ii-redux-snapshots-for-your-actions-and-reducers-8559f6f8050b">Parte 2: Jest – Snapshots Redux para suas Actions e Reducers (em inglês)</a>.</p>
<h2><a class="anchor" name="instalac-o"></a>Instalação <a class="hash-link" href="#instalac-o">#</a></h2>
<p>A partir da versão 0.38 de react-native, uma instalação Jest é incluída por padrão, ao executar <code>react-native init</code>. A seguinte configuração deve ser automaticamente adicionada ao seu arquivo package.json:</p>
<pre><code class="language-json">// package.json
  "scripts": {
    "test": "jest"
  },
  "jest": {
    "preset": "react-native"
  }
</code></pre>
<p><em>Nota: Se você estiver atualizando seu aplicativo react-native e anteriormente usou a predefinição <code>jest-react-native</code>, remova a dependência de seu arquivo <code>package.json</code> e altere a predefinição para <code>react-native</code> em vez disso.</em></p>
<p>Basta executar <code>npm test</code> para executar testes com Jest.</p>
<h2><a class="anchor" name="teste-snapshot"></a>Teste Snapshot <a class="hash-link" href="#teste-snapshot">#</a></h2>
<p>Let's create a <a href="/jest/docs/pt-BR/snapshot-testing.html">snapshot test</a> for a small intro component with a few views and text components and some styles:</p>
<pre><code class="language-javascript"><span class="hljs-comment">// Intro.js</span>
<span class="hljs-keyword">import</span> React, {Component} <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> {
  StyleSheet,
  Text,
  View,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native'</span>;

<span class="hljs-keyword">const</span> styles = StyleSheet.create({
  <span class="hljs-attr">container</span>: {
    <span class="hljs-attr">alignItems</span>: <span class="hljs-string">'center'</span>,
    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">'#F5FCFF'</span>,
    <span class="hljs-attr">flex</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">justifyContent</span>: <span class="hljs-string">'center'</span>,
  },
  <span class="hljs-attr">instructions</span>: {
    <span class="hljs-attr">color</span>: <span class="hljs-string">'#333333'</span>,
    <span class="hljs-attr">marginBottom</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attr">textAlign</span>: <span class="hljs-string">'center'</span>,
  },
  <span class="hljs-attr">welcome</span>: {
    <span class="hljs-attr">fontSize</span>: <span class="hljs-number">20</span>,
    <span class="hljs-attr">margin</span>: <span class="hljs-number">10</span>,
    <span class="hljs-attr">textAlign</span>: <span class="hljs-string">'center'</span>,
  },
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Intro</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  render() {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.container}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.welcome}</span>&gt;</span>
          Welcome to React Native!
        <span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.instructions}</span>&gt;</span>
          This is a React Native snapshot test.
        <span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>
    );
  }
}
</code></pre>
<p>Agora vamos usar o renderer de teste do React e o recurso de snapshot do Jest para interagir com o componente e capturar a saída renderizada e criar um arquivo de snapshot:</p>
<pre><code class="language-javascript"><span class="hljs-comment">// __tests__/Intro-test.js</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'react-native'</span>;
<span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> Intro <span class="hljs-keyword">from</span> <span class="hljs-string">'../Intro'</span>;

<span class="hljs-comment">// Nota: o renderer de teste deve ser requerido após react-native.</span>
test(<span class="hljs-string">'renderiza corretamente'</span>, () =&gt; {
  <span class="hljs-keyword">const</span> tree = renderer.create(
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Intro</span> /&gt;</span>
  ).toJSON();
  expect(tree).toMatchSnapshot();
});
</span></code></pre>
<p>Quando você executa o <code>npm test</code> ou <code>jest</code>, isto irá produzir um arquivo de saída como este:</p>
<pre><code class="language-javascript"><span class="hljs-comment">// __tests__/__snapshots__/Intro-test.js.snap</span>
exports[<span class="hljs-string">`Intro renders correctly 1`</span>] = <span class="hljs-string">`
&lt;View
  style={
    Object {
      "alignItems": "center",
      "backgroundColor": "#F5FCFF",
      "flex": 1,
      "justifyContent": "center",
    }
  }&gt;
  &lt;Text
    style={
      Object {
        "fontSize": 20,
        "margin": 10,
        "textAlign": "center",
      }
    }&gt;
    Welcome to React Native!
  &lt;/Text&gt;
  &lt;Text
    style={
      Object {
        "color": "#333333",
        "marginBottom": 5,
        "textAlign": "center",
      }
    }&gt;
    This is a React Native snapshot test.
  &lt;/Text&gt;
&lt;/View&gt;
`</span>;
</code></pre>
<p>Da próxima vez que você executar os testes, a saída renderizada será comparada ao snapshot criado anteriormente. O snapshot deve ser comitado (committed, em inglês) junto com as alterações de código. Quando um teste de snapshot falhar, você precisa inspecionar se é uma mudança pretendida ou não intencional. Se a mudança é esperada, você pode invocar Jest com <code>jest -u</code> para substituir o snapshot existente.</p>
<p>O código deste exemplo está disponível em <a href="https://github.com/facebook/jest/tree/master/examples/react-native">examples/react-native</a>.</p>
<h2><a class="anchor" name="configurac-o-predefinida"></a>Configuração predefinida <a class="hash-link" href="#configurac-o-predefinida">#</a></h2>
<p>A predefinição configura o ambiente e é muito opinativa e baseada no que tem se mostrado ser útil no Facebook. Todas as opções de configuração podem ser substituídas assim como eles podem ser personalizados quando nenhuma predefinição é usada.</p>
<h3><a class="anchor" name="ambiente"></a>Ambiente <a class="hash-link" href="#ambiente">#</a></h3>
<p><code>react-native</code> vem com uma pré-definição Jest, então o campo <code>jest.preset</code> de seu <code>package.json</code> deve apontar para <code>react-native</code>. A predefinição é um ambiente node que imita o ambiente de um app React Native. Porque ele não carrega nenhum DOM ou APIs de navegador, melhora consideravelmente o tempo de inicialização do Jest.</p>
<h3><a class="anchor" name="personalizac-o-de-transformignorepatterns"></a>personalização de transformIgnorePatterns <a class="hash-link" href="#personalizac-o-de-transformignorepatterns">#</a></h3>
<p>A opção <a href="configuration.html#transformignorepatterns-array-string"> <code>transformIgnorePatterns</code></a> pode ser usada para arquivos de lista branca ou lista negra de serem transformados com Babel. Muitos módulos npm de react-native infelizmente não pre-compilam seu código fonte antes de publicar.</p>
<p>Por padrão a predefinição jest-react-native só processa os arquivos fonte do projeto e react-native. Se você tem dependências npm que tem que ser transformadas, você pode personalizar esta opção de configuração por colocar módulos que não sejam o react-native em uma lista branca:</p>
<pre><code class="language-json">"transformIgnorePatterns": [
  "node_modules/(?!(react-native|my-project|react-native-button)/)"
]
</code></pre>
<h3><a class="anchor" name="setupfiles"></a>setupFiles <a class="hash-link" href="#setupfiles">#</a></h3>
<p>Se você gostaria de fornecer configuração adicional para cada arquivo de teste, a <a href="configuration.html#setupfiles-array">opção de configuração <code>setupFiles</code></a> pode ser usada para especificar os scripts de instalação.</p>
<h3><a class="anchor" name="modulenamemapper"></a>moduleNameMapper <a class="hash-link" href="#modulenamemapper">#</a></h3>
<p>O <a href="configuration.html#modulenamemapper-object-string-string"> <code>moduleNameMapper</code></a> pode ser usado para mapear um caminho de módulo para um módulo diferente. Por padrão a predefinição mapeia todas as imagens para um módulo de esboço de imagem, mas se um módulo não pode ser encontrado esta opção de configuração pode ajudar:</p>
<pre><code class="language-json">"moduleNameMapper": {
  "my-module.js": "&lt;rootDir&gt;/path/to/my-module.js"
}
</code></pre>
<h2><a class="anchor" name="dicas"></a>Dicas <a class="hash-link" href="#dicas">#</a></h2>
<h3><a class="anchor" name="simule-mock-em-ingles-modulos-nativos-usando-jestmock"></a>Simule (mock, em inglês) módulos nativos usando jest.mock <a class="hash-link" href="#simule-mock-em-ingles-modulos-nativos-usando-jestmock">#</a></h3>
<p>A predefinição Jest interna do <code>react-native</code> vem com algumas simulações (mocks, em inglês) padrão que são aplicadas em um repositório react-native. No entanto, alguns componentes react-native ou componentes de terceiros dependem de código nativo para serem renderizados. Em tais casos, o sistema manual de simulação do Jest pode ajudar a simular a implementação subjacente.</p>
<p>Por exemplo, se seu código depende de um componente de vídeo nativo de terceiros chamado <code>react-native-video</code> convém esboçar ele com um simulação manual como esta:</p>
<pre><code class="language-js">jest.mock(<span class="hljs-string">'react-native-video'</span>, () =&gt; <span class="hljs-string">'Video'</span>);
</code></pre>
<p>Isto irá renderizar o componente como <code>&lt;Video {...props} /&gt;</code> com todas as suas propriedades no snapshot de saída.</p>
<p>Às vezes você precisa fornecer uma simulação manual mais complexa. Por exemplo, se você gostaria de transmitir os tipos das propriedades ou campos estáticos de um componente nativo para uma simulação (mock, em inglês), você pode retornar um componente React diferente a partir de uma simulação através deste auxiliar do jest-react-native:</p>
<pre><code class="language-js">jest.mock(<span class="hljs-string">'path/to/MyNativeComponent'</span>, () =&gt; {
  <span class="hljs-keyword">const</span> mockComponent = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-native/jest/mockComponent'</span>);
  <span class="hljs-keyword">return</span> mockComponent(<span class="hljs-string">'path/to/MyNativeComponent'</span>);
});
</code></pre>
<p>Ou se você gostaria de criar sua própria simulação manual, você pode fazer algo parecido com isto:</p>
<pre><code class="language-js">jest.mock(<span class="hljs-string">'Text'</span>, () =&gt; {
  <span class="hljs-keyword">const</span> RealComponent = <span class="hljs-built_in">require</span>.requireActual(<span class="hljs-string">'Text'</span>);
  <span class="hljs-keyword">const</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'React'</span>);
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Text</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
    render() {
      <span class="hljs-keyword">return</span> React.createElement(<span class="hljs-string">'Text'</span>, <span class="hljs-keyword">this</span>.props, <span class="hljs-keyword">this</span>.props.children);
    }
  }
  Text.propTypes = RealComponent.propTypes;
  <span class="hljs-keyword">return</span> Text;
});
</code></pre>
<p>Em outros casos, você pode querer simular um módulo nativo que não seja um componente React. A mesma técnica pode ser aplicada. Nós recomendamos inspecionar o código-fonte do módulo nativo e registrar o módulo ao executar um aplicativo react native em um dispositivo real e então modelar uma simulação manual após o módulo real.</p>
<p>Se você acabar por simular os mesmos módulos repetidamente vez após vez é recomendável definir estas simulações em um arquivo separado e adicioná-lo à lista de <code>setupFiles</code>.</p>
<h3><a class="anchor" name="requerir-react-native-antes-do-renderer-de-testes"></a>requerir react-native antes do renderer de testes <a class="hash-link" href="#requerir-react-native-antes-do-renderer-de-testes">#</a></h3>
<p>Atualmente, é necessário requerir react-native antes de carregar o renderizador de teste:</p>
<pre><code>import 'react-native';
// Requerir após react-native
import renderer from 'react-test-renderer';
</code></pre>
<h3><a class="anchor" name="providesmodule"></a><code>@providesModule</code> <a class="hash-link" href="#providesmodule">#</a></h3>
<p>Se você gostaria de usar o sistema de módulo <code>@providesModule</code> do Facebook através de um pacote npm, a opção de configuração padrão &quot;haste&quot; deve ser substituída e módulos npm devem ser adicionados ao <code>providesModuleNodeModules</code>:</p>
<pre><code class="language-json">"haste": {
  "defaultPlatform": "ios",
  "platforms": ["android", "ios"],
  "providesModuleNodeModules": [
    "react",
    "react-native",
    "meu-modulo-incrivel",
    "meu-componente-texto"
  ]
},
</code></pre>
<p>Se você gostaria de testar uma plataforma padrão diferente ou se você está construindo para outras plataformas, a opção de configuração <code>defaultPlatform</code> e <code>platforms</code> pode ser atualizada.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="tutorial-react.html">← Testing React Apps</a><a class="docs-next button" href="testing-frameworks.html">Testing Web Frameworks →</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/jest/" class="nav-home"><img src="/jest/img/jest-outline.svg" alt="Jest" width="66" height="58"/></a><div><h5>Docs</h5><a href="/jest/docs/pt-BR/getting-started.html">Getting Started</a><a href="/jest/docs/pt-BR/snapshot-testing.html">Guides</a><a href="/jest/docs/pt-BR/api.html">API Reference</a></div><div><h5>Community</h5><a href="/jest/pt-BR/users.html">User Showcase</a><a href="https://stackoverflow.com/questions/tagged/jestjs" target="_blank">Stack Overflow</a><a href="https://discordapp.com/channels/102860784329052160/103622435865104384">Jest Chat</a><a href="https://twitter.com/fbjest" target="_blank">Twitter</a></div><div><h5>More</h5><a href="/jest/blog">Blog</a><a href="https://github.com/facebook/jest">GitHub</a><a class="github-button" href="https://github.com/facebook/jest" data-icon="octicon-star" data-count-href="/facebook/jest/stargazers" data-count-api="/repos/facebook/jest#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/jest/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2017 Facebook Inc.</section></footer></div><script type="text/javascript" src="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-44373548-17', 'auto');
              ga('send', 'pageview');
            </script><script>
              var search = docsearch({
                apiKey: '833906d7486e4059359fa58823c4ef56',
                indexName: 'jest',
                inputSelector: '#search_input_react'
              });
            </script><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script></body></html>