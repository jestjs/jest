<html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"/><title>üÉè Jest 19: Immersive Watch Mode &amp; Test Platform Improvements ¬∑ Jest</title><meta name="viewport" content="width=device-width"/><meta property="og:title" content="üÉè Jest 19: Immersive Watch Mode &amp; Test Platform Improvements ¬∑ Jest"/><meta property="og:type" content="website"/><meta property="og:url" content="https://facebook.github.io/jest/blog/2017/02/21/jest-19-immersive-watch-mode-test-platform-improvements.html"/><meta property="og:description" content="Today we are pleased to ship version 19 of the Jest testing platform. It&#x27;s the biggest Jest release we have shipped so far and we are quite excited to show you what we&#x27;ve built over the last two months:"/><meta name="robots" content="noindex"/><meta property="og:image" content="/jest/img/opengraph.png"/><link rel="shortcut icon" href="/jest/img/favicon/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="/jest/css/main.css"/><link rel="alternate" type="application/atom+xml" href="https://facebook.github.io/blog/atom.xml" title="Jest Blog ATOM Feed"/> <link rel="alternate" type="application/rss+xml" href="https://facebook.github.io/blog/feed.xml" title="Jest Blog RSS Feed"/><script async="" defer="" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/jest/js/webplayer.js"></script><script type="text/javascript" src="https://snack.expo.io/embed.js"></script></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/jest/"><img class="logo" src="/jest/img/jest.svg"/><h2 class="headerTitle">Jest</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/jest/docs/en/getting-started.html" target="_self">Docs</a></li><li><a href="/jest/docs/en/api.html" target="_self">API</a></li><li><a href="/jest/en/help.html" target="_self">Help</a></li><li><a href="/jest/blog" target="_self">Blog</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/jest/img/language.svg"/>English</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/jest/ja">Êó•Êú¨Ë™û</a></li><li><a href="/jest/es-ES">Espa√±ol</a></li><li><a href="/jest/pt-BR">Portugu√™s (Brasil)</a></li><li><a href="/jest/ro">Rom√¢nƒÉ</a></li><li><a href="/jest/ru">–†—É—Å—Å–∫–∏–π</a></li><li><a href="/jest/uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</a></li><li><a href="/jest/zh-Hans">ÁÆÄ‰Ωì‰∏≠Êñá</a></li><li><a href="https://crowdin.com/project/jest" target="_blank">Help Translate</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(){
          if(languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search"/></li><li><a href="https://github.com/facebook/jest" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>‚Ä∫</i><span>Recent Posts</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Recent Posts</h3><ul><li class="navListItem"><a class="navItem" href="/jest/blog/2017/05/06/jest-20-delightful-testing-multi-project-runner.html">Jest 20: üíñ Delightful Testing &amp; üèÉüèΩ Multi-Project-Runner</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/jest/blog/2017/02/21/jest-19-immersive-watch-mode-test-platform-improvements.html">üÉè Jest 19: Immersive Watch Mode &amp; Test Platform Improvements</a></li><li class="navListItem"><a class="navItem" href="/jest/blog/2017/01/30/a-great-developer-experience.html">A Great Developer Experience</a></li><li class="navListItem"><a class="navItem" href="/jest/blog/2016/12/15/2016-in-jest.html">2016 in Jest</a></li><li class="navListItem"><a class="navItem" href="/jest/blog/2016/10/03/jest-16.html">Jest 16.0: Turbocharged CLI &amp; Community Update</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer documentContainer postContainer blogContainer"><div class="wrapper"><div class="lonePost"><div class="post"><header class="postHeader"><div class="authorPhoto"><a href="http://twitter.com/rogeliog" target="_blank"><img src="https://graph.facebook.com/511230566/picture/?height=200&amp;width=200"/></a></div><p class="post-authorName"><a href="http://twitter.com/rogeliog" target="_blank">Rogelio Guzman</a><br/></p><h1><a href="/jest/blog/2017/02/21/jest-19-immersive-watch-mode-test-platform-improvements.html">üÉè Jest 19: Immersive Watch Mode &amp; Test Platform Improvements</a></h1><p class="post-meta">February 21, 2017</p></header><div><p>Today we are pleased to ship version 19 of the Jest testing platform. It&#x27;s the biggest Jest release we have shipped so far and we are quite excited to show you what we&#x27;ve built over the last two months:</p><h2><a class="anchor" name="immersive-watch-mode"></a>Immersive Watch Mode <a class="hash-link" href="#immersive-watch-mode">#</a></h2><p>We <a href="https://github.com/facebook/jest/pull/2362" target="_blank">completely rewrote the watch mode</a> to make it instant and more extensible. As a result, the experience of using it really is immersive: tests re-run instantly after a file change and we made it easy to select the right tests.</p><div><!--truncate-->

</div><h2><a class="anchor" name="snapshot-updates"></a>Snapshot Updates <a class="hash-link" href="#snapshot-updates">#</a></h2><p>We made a couple of changes to the snapshot format. We don&#x27;t make changes like this often and only consider them if they actually improve how snapshots work. As well as introducing a snapshot version number we accumulated a number of changes we wanted to make to the format for a while:</p><ul><li>We dropped the ‚Äútest‚Äù prefix in snapshot names from top level <code>test</code> or <code>it</code> calls.</li><li>We improved the printing of React elements to cause less changes when the last prop in an element changes.</li><li>We improved the character escaping mechanism to be more bulletproof.</li></ul><p>Before:</p><pre class="prism language-javascript">exports<span class="token punctuation">[</span><span class="token template-string"><span class="token string">`test snap 1`</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token template-string"><span class="token string">`
&lt;header&gt;
  &lt;h1&gt;
    Jest \&quot;19\&quot;
  &lt;/h1&gt;
  &lt;Subtitle
    name=&quot;Painless JavaScript Testing&quot; /&gt;
&lt;/header&gt;
`</span></span><span class="token punctuation">;</span></pre><p>After (no ‚Äútest‚Äù prefix, better JSX rendering, version header):</p><pre class="prism language-javascript"><span spellcheck="true" class="token comment">// Jest Snapshot v1, https://goo.gl/fbAQLP</span>

exports<span class="token punctuation">[</span><span class="token template-string"><span class="token string">`snap 1`</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token template-string"><span class="token string">`
&lt;header&gt;
  &lt;h1&gt;
    Jest &quot;19&quot;
  &lt;/h1&gt;
  &lt;Subtitle
    name=&quot;Painless JavaScript Testing&quot;
  /&gt;
&lt;/header&gt;
`</span></span><span class="token punctuation">;</span></pre><p>We decided it&#x27;s a good time to introduce versioned snapshots to ensure all developers are using a compatible version of Jest. Here&#x27;s how we warn you about the need to update your snapshot:</p><p><img src="/jest/img/blog/19-snapshot-version.png" alt="snapshot-version"/></p><p>Please make sure you revert any local changes before updating to make the transition smooth and to ensure you aren&#x27;t including any unwanted changes from failing tests in your new snapshots.</p><h2><a class="anchor" name="improved-printing-of-skipped-tests"></a>Improved printing of skipped tests <a class="hash-link" href="#improved-printing-of-skipped-tests">#</a></h2><p>Skipped tests are now printed as a single line instead of showing every individual one when testing in verbose mode or a single suite. Hopefully it will let you focus on currently important tests. It also occupies far less space!</p><p><img src="/jest/img/blog/19-skipped-tests.png" alt="skipped-tests"/></p><h2><a class="anchor" name="new-cli-arguments"></a>New CLI arguments <a class="hash-link" href="#new-cli-arguments">#</a></h2><p>Jest 19 ships with two new coverage-related arguments which you can run from CLI:</p><ul><li><code>--collectCoverageFrom</code></li><li><code>--coverageDirectory</code></li></ul><p>We now also error on invalid CLI arguments instead of ignoring them. But we&#x27;ve got your back with helpful error message like the one below, e.g. when you try running <code>jest --watc</code>:</p><p><img src="/jest/img/blog/19-cli-error.png" alt="cli-error"/></p><h2><a class="anchor" name="expect-improvements"></a><code>expect</code> Improvements <a class="hash-link" href="#expect-improvements">#</a></h2><ul><li><a href="/jest/docs/expect.html#expectaddsnapshotserializerserializer" target=""><code>expect.addSnapshotSerializer</code></a></li><li><a href="/jest/docs/expect.html#expectstringcontainingstring" target=""><code>expect.stringContaining</code></a></li><li><a href="/jest/docs/jest-object.html#jestspyonobject-methodname" target=""><code>jest.spyOn</code></a></li></ul><p>We&#x27;re close to almost full feature parity with the <code>expect</code> npm package. <a href="https://twitter.com/mjackson" target="_blank">Michael Jackson</a>, the author of the package, agreed to <a href="https://github.com/facebook/jest/issues/1679" target="_blank">donate</a> it to the Jest project, which means that <code>jest-matchers</code> will be renamed to <code>expect</code>. Since our version of <code>expect</code> is not intended to be fully compatible, <a href="https://twitter.com/Vjeux" target="_blank">Christopher Chedeau</a> is working on a codemod to make the transition painless. Christopher also worked on a number of improvements to <code>jest-matchers</code> which enables it to be used outside of Jest and even <a href="https://github.com/facebook/jest/pull/2795" target="_blank">works inside browsers</a>.</p><h2><a class="anchor" name="eslint-plugin-jest-https-githubcom-facebook-jest-tree-master-packages-eslint-plugin-jest-our-very-own-eslint-plugin"></a><a href="https://github.com/facebook/jest/tree/master/packages/eslint-plugin-jest" target="_blank">eslint-plugin-jest</a> ‚Äì our very own ESLint plugin <a class="hash-link" href="#eslint-plugin-jest-https-githubcom-facebook-jest-tree-master-packages-eslint-plugin-jest-our-very-own-eslint-plugin">#</a></h2><p>Thanks to <a href="https://twitter.com/jonnykim" target="_blank">Jonathan Kim</a> Jest finally has its own official ESLint plugin. It exposes three rules:</p><ul><li><a href="https://github.com/facebook/jest/blob/master/packages/eslint-plugin-jest/docs/rules/no-disabled-tests.md" target="_blank">no-disabled-tests</a> - this rule prevents you from accidentally committing disabled tests.</li><li><a href="https://github.com/facebook/jest/blob/master/packages/eslint-plugin-jest/docs/rules/no-focused-tests.md" target="_blank">no-focused-tests</a> - this rule prevents you from committing focused tests which would disable all other tests in the same suite.</li><li><a href="https://github.com/facebook/jest/blob/master/packages/eslint-plugin-jest/docs/rules/no-identical-title.md" target="_blank">no-identical-title</a> - disallows identical titles in test names.</li></ul><p>You can install it using <code>npm install eslint-plugin-jest</code> or <code>yarn add --dev eslint eslint-plugin-jest</code> and it can be enabled by adding <code>{&quot;plugins&quot;: [&quot;jest&quot;]}</code> to your eslint configuration.</p><h2><a class="anchor" name="new-public-package-jest-validate-https-githubcom-facebook-jest-tree-master-packages-jest-validate"></a>New public package: <a href="https://github.com/facebook/jest/tree/master/packages/jest-validate" target="_blank">jest-validate</a> <a class="hash-link" href="#new-public-package-jest-validate-https-githubcom-facebook-jest-tree-master-packages-jest-validate">#</a></h2><p>While we refactored the validation and normalization code for Jest&#x27;s configuration, we were so happy with the new error messaging that we extracted it to its own module to share it with everyone. With Jest 19 we welcome <code>jest-validate</code> to our self-sustained packages family.</p><p><code>jest-validate</code> is a generic configuration validation tool that helps you with warnings, errors and deprecation messages in your JavaScript tool. It&#x27;s also capable of showing users friendly examples of correct configuration and it comes with a simple but powerful API. We hope it&#x27;ll make a good addition to your projects!</p><p><img src="/jest/img/blog/19-validate.png" alt="validate"/></p><p>We&#x27;re happy to announce that <code>jest-validate</code> is validating config options of <a href="https://github.com/jlongster/prettier" target="_blank">prettier</a> since <a href="https://github.com/jlongster/prettier/blob/master/CHANGELOG.md#0120" target="_blank">v0.12</a>. Feel free to add it to your project, try it, send us feedback and improve it by making pull requests on GitHub.</p><h2><a class="anchor" name="improved-asymmetric-matchers"></a>Improved asymmetric matchers <a class="hash-link" href="#improved-asymmetric-matchers">#</a></h2><p>We moved the asymmetric matchers implementation from Jasmine into Jest, which enabled us to further improve the user experience around them. As a result, asymmetric matchers are now pretty-printed nicely, we added the new <a href="http://facebook.github.io/jest/docs/expect.html#expectstringcontainingstring" target="_blank"><code>expect.stringContaining()</code></a> matcher and we also paired them with <a href="http://facebook.github.io/jest/docs/expect.html#tomatchobjectobject" target="_blank"><code>expect.toMatchObject()</code></a> so you can use the best of both:</p><p><img src="/jest/img/blog/19-asymmetric-matchers.png" alt="asymmetric-matchers"/></p><h2><a class="anchor" name="better-manual-mocks"></a>Better manual mocks <a class="hash-link" href="#better-manual-mocks">#</a></h2><p>With the latest release, manual mocks now finally work with nested folders. For example <code>__mocks__/react-native/Libraries/Text/Text.js</code> will now work as expected and mock the correct module. We also fixed issues with virtual mocks and transitive dependencies and improved <code>moduleNameMapper</code> to not overwrite mocks when many patterns map to the same file.</p><h2><a class="anchor" name="breaking-changes"></a>Breaking Changes <a class="hash-link" href="#breaking-changes">#</a></h2><p>As a part of our cleanups and fixes we removed the <code>mocksPattern</code> configuration option which was never officially supported. We also renamed the <code>testPathDirs</code> configuration option to <code>roots</code> which better explains what the option can be used for. The default configuration for <code>roots</code> is <code>[&quot;&lt;rootDir&gt;&quot;]</code> and can be customized to include any number of directories. The rootDir configuration option has always been used mostly as a token for other configuration options and this rename should make configuring Jest clearer.</p><h2><a class="anchor" name="revamped-documentation"></a>Revamped documentation <a class="hash-link" href="#revamped-documentation">#</a></h2><p>As you may have already seen, <a href="https://twitter.com/hectorramos" target="_blank">Hector Ramos</a> and <a href="https://twitter.com/lacker" target="_blank">Kevin Lacker</a> gave Jest&#x27;s documentation a fresh new look. We changed the way we organize the website and it now features Docs and API as separate pages:</p><ul><li>Under <a href="https://facebook.github.io/jest/docs/getting-started.html#content" target="_blank">Docs</a> you can find an introduction to Jest, including <a href="https://facebook.github.io/jest/docs/getting-started.html#content" target="_blank">Getting Started</a> or <a href="https://facebook.github.io/jest/docs/asynchronous.html#content" target="_blank">Testing Asynchronous Code</a> and handy guides like <a href="https://facebook.github.io/jest/docs/snapshot-testing.html#content" target="_blank">Snapshot Testing</a>, <a href="https://facebook.github.io/jest/docs/tutorial-react-native.html#content" target="_blank">Testing React Native App</a>, <a href="https://facebook.github.io/jest/docs/webpack.html#content" target="_blank">Using with webpack</a> or <a href="https://facebook.github.io/jest/docs/migration-guide.html#content" target="_blank">Migrating to Jest</a> and many more!</li><li>The <a href="https://facebook.github.io/jest/docs/api.html" target="_blank">API</a> section on the other hand lists all available methods exposed by Jest: the <code>expect</code> and <code>jest</code> objects, mock functions, globals, along with configuration options from <em>package.json</em> and from the CLI.</li></ul><p>The homepage was completely redesigned to be more descriptive of what Jest is about: ‚Äú<em>Zero configuration testing platform</em>‚Äù. We also made sure it reads better on mobile devices. And for those using RSS ‚Äì we finally provide a <a href="http://facebook.github.io/jest/blog/feed.xml" target="_blank">feed for our blog</a>.</p><h2><a class="anchor" name="community-updates"></a>Community Updates <a class="hash-link" href="#community-updates">#</a></h2><ul><li>We really loved this talk: ‚Äú<a href="https://www.youtube.com/watch?v=tvy0bSgwtTo" target="_blank">Introduction to Jest</a>‚Äú by Vas Boroviak.</li><li>Follow <a href="http://twitter.com/fbjest" target="_blank">@fbjest on Twitter</a>.</li><li>The Jest Core team syncs once a week to discuss current and future issues. If you&#x27;d like to work on Jest, let us know, submit a few pull requests and join our weekly team meetings.</li><li>The awesome engineers at Artsy wrote <a href="http://artsy.github.io/blog/2017/02/05/Front-end-JavaScript-at-Artsy-2017/" target="_blank">about Jest as part of their 2017 frontend stack</a>.</li><li>Stephen Scott wrote a detailed article about <a href="https://medium.freecodecamp.com/the-right-way-to-test-react-components-548a4736ab22" target="_blank">testing React components</a> in which he weighs the pros and cons of different approaches.</li><li><a href="https://medium.com/@kentaromiura_the_js_guy/jest-for-all-episode-1-vue-js-d616bccbe186#.r8ryxlw98" target="_blank">Using Jest with vue.js</a> got a lot easier after reading Cristian Carlesso&#x27;s blog post.</li><li><a href="https://twitter.com/cpojer/status/825004258219130880" target="_blank">Michele Bertoli wrote a book about React Design Patterns and Best Practices</a> which features an entire section about Jest.</li><li>Improved <code>--notify</code> command that shows an operating system notification which <a href="https://github.com/facebook/jest/pull/2727" target="_blank">can now also re-run tests from the notification</a>. This is actually a Jest feature and we are just checking if you are still reading this blog post.</li><li>Jest is now part of <a href="https://twitter.com/mxstbr/status/820326656439177217" target="_blank">react-boilerplate</a>.</li><li>Read about the <a href="https://medium.com/@boriscoder/the-hidden-power-of-jest-matchers-f3d86d8101b0#.pn10z1pzx" target="_blank">hidden powers of Jest&#x27;s matchers</a>.</li></ul><p>Finally, we are happy to announce that the <a href="https://github.com/avajs/ava" target="_blank">ava</a> test runner has adopted parts of the Jest platform and is now shipping with basic <a href="https://github.com/avajs/ava#snapshot-testing" target="_blank">snapshot support</a> and is using <a href="https://github.com/facebook/jest/tree/master/packages/pretty-format" target="_blank">pretty-format</a>. Consolidating test infrastructure makes it easier to learn how to test applications and enables us to share best practices. We are looking forward to see what we can learn from existing test libraries in the future.</p><p>The full <a href="https://github.com/facebook/jest/blob/master/CHANGELOG.md#jest-1900" target="_blank">changelog can be found on GitHub</a>. Jest 19 was a true JavaScript community effort with <a href="https://github.com/facebook/jest/graphs/contributors?from=2016-12-23&amp;to=2017-02-21&amp;type=c" target="_blank">17 people who contributed</a> to this release. We thank each and every one of you for your help to make this project great.</p><p><em>This blog post was written by <a href="https://twitter.com/rogeliog" target="_blank">Rogelio Guzman</a> and <a href="https://twitter.com/thymikee" target="_blank">Micha≈Ç Pierzcha≈Ça</a>.</em></p></div></div></div><div class="blog-recent"><a class="button" href="/jest/blog">Recent Posts</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/jest/" class="nav-home"><img src="/jest/img/jest-outline.svg" alt="Jest" width="66" height="58"/></a><div><h5>Docs</h5><a href="/jest/docs/en/getting-started.html">Getting Started</a><a href="/jest/docs/en/snapshot-testing.html">Guides</a><a href="/jest/docs/en/api.html">API Reference</a></div><div><h5>Community</h5><a href="/jest/en/users.html">User Showcase</a><a href="https://stackoverflow.com/questions/tagged/jestjs" target="_blank">Stack Overflow</a><a href="https://discordapp.com/channels/102860784329052160/103622435865104384">Jest Chat</a><a href="https://twitter.com/fbjest" target="_blank">Twitter</a></div><div><h5>More</h5><a href="/jest/blog">Blog</a><a href="https://github.com/facebook/jest">GitHub</a><a class="github-button" href="https://github.com/facebook/jest" data-icon="octicon-star" data-count-href="/facebook/jest/stargazers" data-count-api="/repos/facebook/jest#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/jest/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright ¬© 2017 Facebook Inc.</section></footer></div><script type="text/javascript" src="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-44373548-17', 'auto');
              ga('send', 'pageview');
            </script><script>
              var search = docsearch({
                apiKey: '833906d7486e4059359fa58823c4ef56',
                indexName: 'jest',
                inputSelector: '#search_input_react'
              });
            </script></body></html>